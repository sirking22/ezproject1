# üöÄ –£–ª—É—á—à–µ–Ω–Ω–∞—è —Å–∏—Å—Ç–µ–º–∞ —Ä–∞–±–æ—Ç—ã —Å Notion

## üìã –ß—Ç–æ –±—ã–ª–æ —Å–æ–∑–¥–∞–Ω–æ

### 1. **SimpleNotionManager** (`src/services/notion_manager_simple.py`)
–ù–æ–≤—ã–π –º–µ–Ω–µ–¥–∂–µ—Ä –¥–ª—è —á–µ—Ç–∫–æ–π —Ä–∞–±–æ—Ç—ã —Å –±–∞–∑–∞–º–∏ –¥–∞–Ω–Ω—ã—Ö Notion:

**–û—Å–Ω–æ–≤–Ω—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏:**
- ‚úÖ –ü—Ä–æ—Å—Ç–æ–π –∏ –ø–æ–Ω—è—Ç–Ω—ã–π API
- ‚úÖ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è –≤–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å—Ö–µ–º–∞–º
- ‚úÖ –î–µ—Ç–∞–ª—å–Ω—ã–µ —Ä–µ–∑—É–ª—å—Ç–∞—Ç—ã –æ–ø–µ—Ä–∞—Ü–∏–π —Å –æ—à–∏–±–∫–∞–º–∏
- ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è
- ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –≤—Å–µ—Ö —Ç–∏–ø–æ–≤ –ø–æ–ª–µ–π Notion

### 2. **EnhancedBot** (`enhanced_bot.py`)
–£–ª—É—á—à–µ–Ω–Ω—ã–π —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç —Å –Ω–æ–≤—ã–º –º–µ–Ω–µ–¥–∂–µ—Ä–æ–º:

**–ù–æ–≤—ã–µ —Ñ—É–Ω–∫—Ü–∏–∏:**
- ü§ñ –ò–Ω—Ç–µ—Ä–∞–∫—Ç–∏–≤–Ω—ã–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏
- üìÅ –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- üí° –°–æ–∑–¥–∞–Ω–∏–µ –∏–¥–µ–π –∏–∑ —Ç–µ–∫—Å—Ç–∞ —Å LLM
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ —Ä–∞–±–æ—Ç—ã
- üñºÔ∏è –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∞—è —É—Å—Ç–∞–Ω–æ–≤–∫–∞ –æ–±–ª–æ–∂–µ–∫

### 3. **–¢–µ—Å—Ç–æ–≤—ã–π —Ñ–∞–π–ª** (`test_notion_manager.py`)
–ü–æ–ª–Ω—ã–π –Ω–∞–±–æ—Ä —Ç–µ—Å—Ç–æ–≤ –¥–ª—è –ø—Ä–æ–≤–µ—Ä–∫–∏ —Ä–∞–±–æ—Ç—ã —Å–∏—Å—Ç–µ–º—ã.

## üéØ –ö–∞–∫ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å

### –ë–∞–∑–æ–≤–æ–µ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ

```python
from notion_client import AsyncClient
from src.services.notion_manager_simple import SimpleNotionManager
from notion_database_schemas import DATABASE_SCHEMAS

# –ò–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—è
client = AsyncClient(auth="your_notion_token")
manager = SimpleNotionManager(client, DATABASE_SCHEMAS)

# –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏
task_data = {
    "title": "–ú–æ—è –Ω–æ–≤–∞—è –∑–∞–¥–∞—á–∞",
    "description": "–û–ø–∏—Å–∞–Ω–∏–µ –∑–∞–¥–∞—á–∏",
    "status": "To do",
    "priority": "!!!"
}

result = await manager.create_task(task_data)

if result.success:
    print(f"‚úÖ –ó–∞–¥–∞—á–∞ —Å–æ–∑–¥–∞–Ω–∞: {result.data['id']}")
    print(f"üîó URL: {result.data['url']}")
else:
    print(f"‚ùå –û—à–∏–±–∫–∞: {result.error}")
```

### –°–æ–∑–¥–∞–Ω–∏–µ –∏–¥–µ–π

```python
idea_data = {
    "name": "–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è –ø—Ä–æ—Ü–µ—Å—Å–æ–≤",
    "description": "–ò–¥–µ—è –ø–æ —É–ª—É—á—à–µ–Ω–∏—é —Ä–∞–±–æ—á–µ–≥–æ –ø—Ä–æ—Ü–µ—Å—Å–∞",
    "tags": ["–∞–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è", "productivity"],
    "importance": 8,
    "url": "https://example.com"
}

result = await manager.create_idea(idea_data)
```

### –ü–æ–ª—É—á–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö —Å —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏–µ–π

```python
# –ü–æ–ª—É—á–∏—Ç—å –∑–∞–¥–∞—á–∏ —Å–æ —Å—Ç–∞—Ç—É—Å–æ–º "To do"
tasks = await manager.get_tasks(
    filters={"status": "To do"},
    limit=10
)

# –ü–æ–ª—É—á–∏—Ç—å –∏–¥–µ–∏, –æ—Ç—Å–æ—Ä—Ç–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –ø–æ –≤–∞–∂–Ω–æ—Å—Ç–∏
ideas = await manager.get_ideas(limit=20)
```

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –∑–∞–ø–∏—Å–µ–π

```python
# –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å –∑–∞–¥–∞—á–∏
result = await manager.update_task_status(task_id, "In Progress")

# –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å –æ–±–ª–æ–∂–∫—É
result = await manager.set_cover_image(page_id, image_url)
```

## üìä –ü—Ä–µ–∏–º—É—â–µ—Å—Ç–≤–∞ –Ω–æ–≤–æ–π —Å–∏—Å—Ç–µ–º—ã

### 1. **–ß–µ—Ç–∫–æ—Å—Ç—å –∏ –Ω–∞–¥–µ–∂–Ω–æ—Å—Ç—å**
- –Ø–≤–Ω—ã–µ —Ç–∏–ø—ã —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ (`NotionResult`)
- –í–∞–ª–∏–¥–∞—Ü–∏—è –¥–∞–Ω–Ω—ã—Ö –ø–æ —Å—Ö–µ–º–∞–º
- –ü–æ–Ω—è—Ç–Ω—ã–µ —Å–æ–æ–±—â–µ–Ω–∏—è –æ–± –æ—à–∏–±–∫–∞—Ö

### 2. **–ü—Ä–æ—Å—Ç–æ—Ç–∞ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è**
```python
# –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–± (—Å–ª–æ–∂–Ω–æ)
try:
    response = await client.pages.create(
        parent={"database_id": db_id},
        properties={
            "–ó–∞–¥–∞—á–∞": {"title": [{"text": {"content": title}}]},
            "–°—Ç–∞—Ç—É—Å": {"status": {"name": status}}
        }
    )
    # –º–Ω–æ–≥–æ –∫–æ–¥–∞ –æ–±—Ä–∞–±–æ—Ç–∫–∏...
except Exception as e:
    # –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫...

# –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–± (–ø—Ä–æ—Å—Ç–æ)
result = await manager.create_task({
    "title": title,
    "status": status
})

if result.success:
    # —É—Å–ø–µ—Ö!
else:
    print(result.error)
```

### 3. **–ê–≤—Ç–æ–º–∞—Ç–∏–∑–∞—Ü–∏—è**
- –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø—Ä–µ–æ–±—Ä–∞–∑–æ–≤–∞–Ω–∏–µ —Ç–∏–ø–æ–≤ –¥–∞–Ω–Ω—ã—Ö
- –£–º–Ω–æ–µ –æ–ø—Ä–µ–¥–µ–ª–µ–Ω–∏–µ —Ç–∏–ø–∞ –∫–æ–Ω—Ç–µ–Ω—Ç–∞
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å LLM –¥–ª—è –∞–Ω–∞–ª–∏–∑–∞

### 4. **–ú–æ–Ω–∏—Ç–æ—Ä–∏–Ω–≥**
```python
stats = manager.get_stats()
print(f"–£—Å–ø–µ—à–Ω–æ—Å—Ç—å: {stats['success_rate']:.1f}%")
print(f"–í—Å–µ–≥–æ –∑–∞–ø—Ä–æ—Å–æ–≤: {stats['total_requests']}")
```

## üîß –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è –≤ —Å—É—â–µ—Å—Ç–≤—É—é—â–∏–π –ø—Ä–æ–µ–∫—Ç

### 1. **–ó–∞–º–µ–Ω–∞ –≤ —Ç–µ–∫—É—â–µ–º –±–æ—Ç–µ**

–í `simple_bot.py` –∑–∞–º–µ–Ω–∏—Ç–µ:

```python
# –°—Ç–∞—Ä—ã–π —Å–ø–æ—Å–æ–±
class NotionManager:
    async def create_idea(self, fields, file_url, file_name):
        # –º–Ω–æ–≥–æ –∫–æ–¥–∞...

# –ù–æ–≤—ã–π —Å–ø–æ—Å–æ–±  
from src.services.notion_manager_simple import SimpleNotionManager

manager = SimpleNotionManager(notion_client, DATABASE_SCHEMAS)

async def create_idea_simple(idea_data):
    return await manager.create_idea(idea_data)
```

### 2. **–ò—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏–µ –≤ –Ω–æ–≤–æ–º –±–æ—Ç–µ**

–ü—Ä–æ—Å—Ç–æ –∑–∞–ø—É—Å—Ç–∏—Ç–µ `enhanced_bot.py`:

```bash
python enhanced_bot.py
```

**–ù–æ–≤—ã–µ –≤–æ–∑–º–æ–∂–Ω–æ—Å—Ç–∏ –±–æ—Ç–∞:**
- üéõÔ∏è –ì–ª–∞–≤–Ω–æ–µ –º–µ–Ω—é —Å –∫–Ω–æ–ø–∫–∞–º–∏
- üìù –°–æ–∑–¥–∞–Ω–∏–µ –∑–∞–¥–∞—á —á–µ—Ä–µ–∑ —Ñ–æ—Ä–º—É
- üí° –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ —Å–æ–∑–¥–∞–Ω–∏–µ –∏–¥–µ–π –∏–∑ —Ç–µ–∫—Å—Ç–∞
- üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏

## üéØ –°–ª–µ–¥—É—é—â–∏–µ —à–∞–≥–∏

### 1. **–¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ**
```bash
python test_notion_manager.py
```

### 2. **–ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–∞—è –º–∏–≥—Ä–∞—Ü–∏—è**
- –ù–∞—á–Ω–∏—Ç–µ —Å –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- –ü–æ—Å—Ç–µ–ø–µ–Ω–Ω–æ –∑–∞–º–µ–Ω–∏—Ç–µ —Å—Ç–∞—Ä—ã–π –∫–æ–¥
- –ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –æ–±–∞ –ø–æ–¥—Ö–æ–¥–∞ –ø–∞—Ä–∞–ª–ª–µ–ª—å–Ω–æ

### 3. **–†–∞—Å—à–∏—Ä–µ–Ω–∏–µ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞**
- –î–æ–±–∞–≤—å—Ç–µ –Ω–æ–≤—ã–µ –º–µ—Ç–æ–¥—ã –≤ `SimpleNotionManager`
- –°–æ–∑–¥–∞–π—Ç–µ —Å–ø–µ—Ü–∏–∞–ª–∏–∑–∏—Ä–æ–≤–∞–Ω–Ω—ã–µ –º–µ–Ω–µ–¥–∂–µ—Ä—ã –¥–ª—è —Ä–∞–∑–Ω—ã—Ö –±–∞–∑
- –ò–Ω—Ç–µ–≥—Ä–∏—Ä—É–π—Ç–µ —Å –¥—Ä—É–≥–∏–º–∏ —Å–µ—Ä–≤–∏—Å–∞–º–∏

## üîç –ü—Ä–∏–º–µ—Ä—ã –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è

### –°–æ–∑–¥–∞–Ω–∏–µ –∫–æ–º–ø–ª–µ–∫—Å–Ω–æ–π –∑–∞–¥–∞—á–∏

```python
task_data = {
    "title": "–†–∞–∑—Ä–∞–±–æ—Ç–∞—Ç—å –Ω–æ–≤—É—é —Ñ–∏—á—É",
    "description": "–ü–æ–¥—Ä–æ–±–Ω–æ–µ —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–æ–µ –∑–∞–¥–∞–Ω–∏–µ...",
    "status": "To do",
    "priority": "!!!",
    "date": "2024-02-15",
    "participants": ["user_id_1", "user_id_2"]
}

result = await manager.create_task(task_data)
```

### –ú–∞—Å—Å–æ–≤–∞—è —Ä–∞–±–æ—Ç–∞ —Å –¥–∞–Ω–Ω—ã–º–∏

```python
# –ü–æ–ª—É—á–∏—Ç—å –≤—Å–µ –∑–∞–¥–∞—á–∏ –≤ —Ä–∞–±–æ—Ç–µ
in_progress = await manager.get_tasks(
    filters={"status": "In Progress"}
)

# –û–±–Ω–æ–≤–∏—Ç—å —Å—Ç–∞—Ç—É—Å—ã
for task in in_progress.data:
    if should_complete(task):
        await manager.update_task_status(task['id'], "Done")
```

### –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è —Å —Ñ–∞–π–ª–∞–º–∏

```python
# –ü—Ä–∏ –∑–∞–≥—Ä—É–∑–∫–µ —Ñ–∞–π–ª–∞
file_result = await ya_uploader.upload_file(file_url, filename)

if file_result['success']:
    # –°–æ–∑–¥–∞–µ–º –º–∞—Ç–µ—Ä–∏–∞–ª
    material_result = await manager.create_material({
        "name": filename,
        "url": file_result['url'],
        "description": "–ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∑–∞–≥—Ä—É–∂–µ–Ω"
    })
    
    # –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º –æ–±–ª–æ–∂–∫—É –µ—Å–ª–∏ –µ—Å—Ç—å preview
    if file_result.get('preview_url'):
        await manager.set_cover_image(
            material_result.data['id'],
            file_result['preview_url']
        )
```

## üìù –†–µ–∑—É–ª—å—Ç–∞—Ç

–¢–µ–ø–µ—Ä—å —É –≤–∞—Å –µ—Å—Ç—å:

1. **–ß–µ—Ç–∫–∞—è —Å–∏—Å—Ç–µ–º–∞** –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å Notion
2. **–ü—Ä–æ—Å—Ç–æ–π API** –±–µ–∑ –ª–∏—à–Ω–µ–π —Å–ª–æ–∂–Ω–æ—Å—Ç–∏  
3. **–ù–∞–¥–µ–∂–Ω–∞—è –æ–±—Ä–∞–±–æ—Ç–∫–∞ –æ—à–∏–±–æ–∫**
4. **–ì–æ—Ç–æ–≤–∞—è –∏–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è** —Å —Ç–µ–ª–µ–≥—Ä–∞–º –±–æ—Ç–æ–º
5. **–ì–∏–±–∫–æ—Å—Ç—å** –¥–ª—è —Ä–∞—Å—à–∏—Ä–µ–Ω–∏—è

**–ò—Å–ø–æ–ª—å–∑—É–π—Ç–µ –Ω–æ–≤—É—é —Å–∏—Å—Ç–µ–º—É –¥–ª—è:**
- ‚úÖ –ë–æ–ª–µ–µ —Å—Ç–∞–±–∏–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç—ã —Å Notion
- ‚úÖ –£–ø—Ä–æ—â–µ–Ω–∏—è –∫–æ–¥–∞
- ‚úÖ –ë—ã—Å—Ç—Ä–æ–≥–æ –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –Ω–æ–≤—ã—Ö —Ñ—É–Ω–∫—Ü–∏–π
- ‚úÖ –õ—É—á—à–µ–≥–æ –∫–æ–Ω—Ç—Ä–æ–ª—è –æ—à–∏–±–æ–∫